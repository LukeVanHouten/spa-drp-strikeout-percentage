ORDER BY AVE_BP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, avg(1.0 * b.H / b.AB) AS AVE_BP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID > 2010
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, avg(1.0 * b.H / b.AB) AS AVE_BP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID > 2010
ORDER BY AVE_BP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, b.H, b.AB, avg(1.0 * b.H / b.AB) AS AVE_BP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID > 2010
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query1 <- '
SELECT Batting.playerID, teamID, R, H, "2B", "3B", HR, nameGiven, nameLast
FROM Batting
JOIN People ON Batting.playerID = People.playerID
WHERE yearID = "2021" AND teamID = "SEA"
'
df1 <- dbGetQuery(conn, query1)
View(df1)
query1 <- '
SELECT Batting.playerID, teamID, R, H, "2B", "3B", HR, nameGiven, nameLast
FROM Batting
JOIN People ON Batting.playerID = People.playerID
WHERE yearID = "2018" AND teamID = "BOS"
'
df1 <- dbGetQuery(conn, query1)
View(df1)
query1 <- '
SELECT Batting.playerID, teamID, R, H, "2B", "3B", HR, nameGiven, nameLast
FROM Batting
JOIN People ON Batting.playerID = People.playerID
WHERE yearID = "2020" AND teamID = "BOS"
'
df1 <- dbGetQuery(conn, query1)
View(df1)
query1 <- '
SELECT Batting.playerID, teamID, R, H, "2B", "3B", HR, nameGiven, nameLast, AB
FROM Batting
JOIN People ON Batting.playerID = People.playerID
WHERE yearID = "2020" AND teamID = "BOS"
'
df1 <- dbGetQuery(conn, query1)
View(df1)
query <- '
SELECT b.teamId, b.yearId, b.H, b.AB, avg(b.H) / avg(b.AB) AS AVE_BP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID > 2010
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, b.H, b.AB, avg(b.H) / avg(b.AB) AS AVE_BA
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2010
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, avg(b.H) / avg(b.AB) AS AVE_BA
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID > 2010
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, avg(b.H) / avg(b.AB) AS AVE_BA
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2010
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BA DESC
'
df <- dbGetQuery(conn, query)
View(df)
SELECT b.teamId, b.yearId, avg(b.H) / avg(b.AB) AS AVE_BA
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2001
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BA DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, avg(b.H) / avg(b.AB) AS AVE_BA
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2001
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BA DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, avg(b.H) / avg(b.AB) AS AVE_BA
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2001
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BA DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, avg(b.H) / avg(b.AB) AS AVE_BA
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2001
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BA DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, avg(b.H) / avg(b.AB) AS AVE_BA
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2002
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BA DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, OBP
FROM BATTING AS b
WHERE b.yeardID = 2002
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
View
View(dbGetQuery)
View(dbGetQuery(conn, 'SELECT Batting'))
View(dbGetQuery(conn, 'SELECT * FROM Batting'))
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yeardID = 2002
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yeardId = 2002
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yeardID = 2002
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2002
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2004
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2001
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2002
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2003
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2004
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2005
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 1972
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 1971
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 1973
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2021
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2019
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2018
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2016
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2014
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT b.teamId, b.yearId, (avg(H) + avg(BB) + avg(HBP)) / (avg(AB) + avg(BB) + avg(HBP) + avg(SF)) AS OBP
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID = 2015
GROUP BY b.teamId, b.yearId
ORDER BY OBP DESC
'
df <- dbGetQuery(conn, query)
View(df)
source("C:/Users/lukev/baseball_drp/week2.R", echo=TRUE)
query <- '
SELECT b.teamId, yearId, avg(H) / avg(AB) AS AVE_BA
FROM BATTING AS b
WHERE b.AB > 0 AND
b.yearID > 2010
GROUP BY b.teamId, b.yearId
ORDER BY AVE_BA DESC
'
df1 <- dbGetQuery(conn, query)
View(df1)
query <- '
SELECT a.playerID, yearID, teamID
FROM AllstarFull as a
'
df <- dbGetQuery(conn, query)
View(df)
source("C:/Users/lukev/baseball_drp/week2.R", echo=TRUE)
query <- '
SELECT a.playerID, yearID, teamID
FROM AllstarFull as a
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT a.playerID, yearID, teamID, COUNT(playerID) as playerCount
FROM AllstarFull as a
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT a.playerID, yearID, teamID, COUNT(*)
FROM AllstarFull as a
GROUP BY teamID
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT a.playerID, yearID, teamID, COUNT(*)
FROM AllstarFull as a
GROUP BY yearID, teamID
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT a.playerID, yearID, teamID, COUNT(*)
FROM AllstarFull as a
GROUP BY yearID, teamID
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT sp.yearID, teamIDwinner
FROM SeriesPost as sp
WHERE round = "WS"
UNION
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT sp.yearID, teamIDwinner
FROM SeriesPost as sp
WHERE round = "WS"
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT yearID, teamIDwinner
FROM SeriesPost
WHERE round = "WS"
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT ws.yearID, teamIDwinner
FROM SeriesPost as ws
WHERE round = "WS"
UNION
SELECT a.playerID, yearID, teamID, COUNT(*)
FROM AllstarFull as a
WHERE teamID in ws.teamIDwinner
GROUP BY a.yearID, teamID
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT sp.yearID, teamIDwinner
FROM SeriesPost as sp
WHERE round = "WS"
'
df <- dbGetQuery(conn, query)
View(df)
source("C:/Users/lukev/baseball_drp/week2.R", echo=TRUE)
query <- '
SELECT sp.yearID, teamIDwinner
FROM SeriesPost as sp
WHERE round = "WS"
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT a.playerID, yearID, teamID, COUNT(*)
FROM AllstarFull as a
GROUP BY yearID, teamID
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT sp.yearID AS year, teamIDwinner, COUNT(AllstarFull.playerID) AS num_all_stars
FROM SeriesPost as sp
JOIN ALLstarFull as a
ON sp.yearID = a.yearID AND
sp.teamIDwinner = a.teamID
WHERE sp.round = "WS"
GROUP BY year
ORDER BY num_all_Stars DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT a.playerID, yearID, teamID, COUNT(*)
FROM AllstarFull as a
GROUP BY yearID, teamID
'
df <- dbGetQuery(conn, query)
View(df)
dbListTables(conn)
table_name <- 'AllstarFull'
dbListFields(conn, table_name)
query <- '
SELECT sp.yearID AS year, teamIDwinner, COUNT(a.playerID) AS num_all_stars
FROM SeriesPost as sp
JOIN ALLstarFull as a
ON sp.yearID = a.yearID AND
sp.teamIDwinner = a.teamID
WHERE sp.round = "WS"
GROUP BY year
ORDER BY num_all_Stars DESC
'
df <- dbGetQuery(conn, query)
View(df)
query <- '
SELECT s.yearID, teamID, SUM(salary) AS salarTotal
FROM SALARIES AS s
WHERE S.yearID = 2006 OR
s.yearID = 2016
GROUP BY s.teamID, s.yearID
'
df <- dbGetQuery(conn, query)
View(df)
source("C:/Users/lukev/baseball_drp/eda/DRP Week 1.R", echo=TRUE)
statcast_data <- my_statcast("Paul", "Sewald", "2021-06-01", "2021-06-30")
View(statcast_data)
