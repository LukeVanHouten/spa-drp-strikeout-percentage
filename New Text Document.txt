View(bbref_df)
bbref_query <- "
SELECT *
FROM People
"
bbref_df <- dbGetQuery(connn, bbref_query)
View(bbref_df)
View(positions_df)
bbref_query <- "
SELECT *
FROM People
"
bbref_df <- dbGetQuery(connn, bbref_query)
View(bbref_df)
View(bbref_df)
bbref_query <- "
SELECT playerID, bbrefID
FROM People
"
bbref_df <- dbGetQuery(connn, bbref_query)
View(bbref_df)
positions_df <- merge(fielding_df, bbref_df, by.x="playerID", by.y="playerID")
View(positions_df
View(positions_df)
source("C:/Users/lukev/baseball_drp/chadwick.R", echo=TRUE)
source("C:/Users/lukev/baseball_drp/chadwick.R", echo=TRUE)
problems()
problems(chadwick0)
chadwick0 <- read_csv("data/chadwick/people-0.csv")
debugSource("C:/Users/lukev/baseball_drp/chadwick.R", echo=TRUE)
chadwick0 <- read_csv("data/chadwick/people-0.csv")
chadwick1 <- read_csv("data/chadwick/people-1.csv")
chadwick2 <- read_csv("data/chadwick/people-2.csv")
chadwick3 <- read_csv("data/chadwick/people-3.csv")
chadwick4 <- read_csv("data/chadwick/people-4.csv")
chadwick5 <- read_csv("data/chadwick/people-5.csv")
chadwick6 <- read_csv("data/chadwick/people-6.csv")
chadwick7 <- read_csv("data/chadwick/people-7.csv")
chadwick8 <- read_csv("data/chadwick/people-8.csv")
chadwick9 <- read_csv("data/chadwick/people-9.csv")
chadwicka <- read_csv("data/chadwick/people-a.csv")
chadwickb <- read_csv("data/chadwick/people-b.csv")
chadwickc <- read_csv("data/chadwick/people-c.csv")
chadwickd <- read_csv("data/chadwick/people-d.csv")
chadwicke <- read_csv("data/chadwick/people-e.csv")
chadwickf <- read_csv("data/chadwick/people-f.csv")
people <- subset(chadwick0, chadwick1, chadwick2, chadwick3, chadwick4,
chadwick5, chadwick6, chadwick7, chadwick8, chadwick9,
chadwicka, chadwickb, chadwickc, chadwickd, chadwicke,
chadwickf)
people <- rbind(chadwick0, chadwick1, chadwick2, chadwick3, chadwick4,
chadwick5, chadwick6, chadwick7, chadwick8, chadwick9,
chadwicka, chadwickb, chadwickc, chadwickd, chadwicke,
chadwickf)
View(people)
people <- rbind(chadwick0, chadwick1, chadwick2, chadwick3, chadwick4,
chadwick5, chadwick6, chadwick7, chadwick8, chadwick9,
chadwicka, chadwickb, chadwickc, chadwickd, chadwicke,
chadwickf) %>%
select(key_mlbam, key_bbref, name_last, name_first, mlb_played_last)
View(people)
strikeout_df <- platoon_s_k_df %>%
select(game_date, pitcher, events, game_year, at_bat_number, inning) %>%
filter(events != "") %>%
# Fix to not group by at bat
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year, game_date) %>%
summarize(innings = n_distinct(inning)) %>%
summarize(innings_game = sum(innings))
# group_by(pitcher, game_year) %>%
# summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game))
View(strikeout_df)
library(DBI)
library(RPostgres)
library(RSQLite)
library(tidyverse)
library(baseballr)
library(xgboost)
library(shapr)
conn <- dbConnect(Postgres(), dbname = "drpstatcast", host = "localhost",
port = 5432, user = "postgres", password = "drppassword")
connn <- dbConnect(SQLite(),  dbname = "data/lahman_1871-2021.sqlite")
sql_df <- dbGetQuery(conn, read_file("week5.sql"))
id_df <- read.csv("player_ids.csv")
positions_query <- "
SELECT playerID, yearID, POS
FROM Fielding
WHERE yearID BETWEEN 2015 AND 2019 OR
yearID == 2021
GROUP BY playerID, POS
"
fielding_df <- dbGetQuery(connn, positions_query)
bbref_query <- "
SELECT playerID, bbrefID
FROM People
"
bbref_df <- dbGetQuery(connn, bbref_query)
positions_df <- merge(fielding_df, bbref_df, by.x="playerID",
by.y="playerID") %>%
select(bbrefID, POS)
names_df <- merge(positions_df, id_df, by.x="bbrefID", by.y="key_bbref") %>%
filter(POS == "P")
platoon_s_k_query <- "
SELECT game_date, pitcher, events, type, game_year, stand, p_throws, at_bat_number, inning
FROM statcast
WHERE game_date NOT BETWEEN '2021-03-01' AND '2021-03-31'
AND game_date NOT BETWEEN '2015-03-28' AND '2015-04-04'
AND game_date NOT BETWEEN '2016-03-28' AND '2016-04-02'
AND game_date NOT BETWEEN '2017-03-28' AND '2017-04-01'
"
platoon_s_k_df <- dbGetQuery(conn, platoon_s_k_query)
strike_platoon_df <- platoon_s_k_df %>%
select(pitcher, game_year, stand, p_throws, type) %>%
group_by(pitcher, game_year) %>%
summarize(platoon_advantage = sum(stand == p_throws) / n(),
strike_percentage = sum(type != "B") / n())
View(strikeout_df)
platoon_s_k_df <- dbGetQuery(conn, platoon_s_k_query)
strike_platoon_df <- platoon_s_k_df %>%
select(pitcher, game_year, stand, p_throws, type) %>%
group_by(pitcher, game_year) %>%
summarize(platoon_advantage = sum(stand == p_throws) / n(),
strike_percentage = sum(type != "B") / n())
strikeout_df <- platoon_s_k_df %>%
select(game_date, pitcher, events, game_year, at_bat_number, inning) %>%
filter(events != "") %>%
# Fix to not group by at bat
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year, game_date) %>%
summarize(innings = n_distinct(inning)) %>%
summarize(innings_game = sum(innings))
strikeout_df <- platoon_s_k_df %>%
select(game_date, pitcher, events, game_year, at_bat_number, inning) %>%
filter(events != "") %>%
# Fix to not group by at bat
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year, game_date, inning) %>%
summarize(innings = n_distinct(inning)) %>%
summarize(innings_game = sum(innings))
# group_by(pitcher, game_year) %>%
# summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game))
View(strikeout_df)
strikeout_df <- platoon_s_k_df %>%
select(game_date, pitcher, events, game_year, at_bat_number, inning) %>%
filter(events != "") %>%
# Fix to not group by at bat
group_by(pitcher, game_year, game_date, at_bat_number, inning) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year, game_date, inning) %>%
summarize(innings = n_distinct(inning)) %>%
summarize(innings_game = sum(innings))
# group_by(pitcher, game_year) %>%
# summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game))
View(strikeout_df)
View(platoon_s_k_df)
strikeout_df <- platoon_s_k_df %>%
select(game_date, pitcher, events, game_year, at_bat_number, inning) %>%
filter(events != "") %>%
# Fix to not group by at bat
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
ungroup() %>%
group_by(pitcher, game_year, game_date) %>%
summarize(innings = n_distinct(inning)) %>%
summarize(innings_game = sum(innings))
# group_by(pitcher, game_year) %>%
# summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game))
View(strikeout_df)
strikeout_df <- platoon_s_k_df %>%
select(game_date, pitcher, events, game_year, at_bat_number, inning) %>%
filter(events != "") %>%
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year) %>%
summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game))
View(strikeout_df)
innings_pitched_df <- platoon_s_k_df %>%
group_by(pitcher, game_year, game_date, inning) %>%
summarize(innings = n_distinct(inning)) %>%
summarize(innings_game = sum(innings))
View(innings_pitched_df)
innings_pitched_df <- platoon_s_k_df %>%
group_by(pitcher, game_year, game_date, inning) %>%
summarize(innings = max(inning))
# summarize(innings_game = sum(innings))
View(innings_pitched_df)
innings_pitched_df <- platoon_s_k_df %>%
group_by(pitcher, game_year, game_date, inning) %>%
summarize(innings = n_distinct(inning)) %>%
summarize(innings_game = sum(innings))
View(innings_pitched_df)
innings_pitched_df <- platoon_s_k_df %>%
group_by(pitcher, game_year, game_date, inning) %>%
summarize(innings = n_distinct(inning)) %>%
summarize(innings_game = sum(innings))
View(innings_pitched_df)
innings_pitched_df <- platoon_s_k_df %>%
group_by(pitcher, game_year, game_date, inning) %>%
summarize(innings = n_distinct(inning)) %>%
summarize(innings_game = sum(innings)) %>%
group_by(pitcher, game_year) %>%
summarize(innings_pitched = sum(innings_game))
View(innings_pitched_df)
platoon_s_k_query <- "
SELECT game_date, pitcher, events, type, game_year, stand, p_throws, at_bat_number, ax
FROM statcast
WHERE game_date NOT BETWEEN '2021-03-01' AND '2021-03-31'
AND game_date NOT BETWEEN '2015-03-28' AND '2015-04-04'
AND game_date NOT BETWEEN '2016-03-28' AND '2016-04-02'
AND game_date NOT BETWEEN '2017-03-28' AND '2017-04-01'
"
View(platoo_s_k_df)
View(platoon_s_k_df)
platoon_s_k_df <- dbGetQuery(conn, platoon_s_k_query)
View(platoon_s_k_df)
pitch_count_df <- platoo_s_k_df %>%
group_by(pitcher, game_year, ax) %>%
summarize(pitch = n_distinct(ax))
View(pitch_count_df)
pitch_count_df <- platoon_s_k_df %>%
group_by(pitcher, game_year, ax) %>%
summarize(pitch = n_distinct(ax))
View(pitch_count_df)
pitch_count_df <- platoon_s_k_df %>%
group_by(pitcher, game_year) %>%
summarize(pitch = n())
View(pitch_count_df)
strikeout_df <- platoon_s_k_df %>%
select(game_date, pitcher, events, game_year, at_bat_number, inning) %>%
filter(events != "") %>%
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year) %>%
summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game),
pitch = n())
View(strikeout_df)
strikeout_df <- platoon_s_k_df %>%
select(game_date, pitcher, events, game_year, at_bat_number) %>%
filter(events != "") %>%
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year) %>%
summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game),
pitch = n())
View(strikeout_df)
source("C:/Users/lukev/baseball_drp/week7.R")
joined_df <- merge(merge(merge(strike_platoon_df, pitch_count_df,
by = c("pitcher", "game_year"),
all.x = TRUE), strikeout_df,
by = c("pitcher", "game_year"), all.x = TRUE),
sql_df, by = c("pitcher", "game_year"),
all.x = TRUE)
View(joined_df)
strikeout_df <- platoon_s_k_pitches_df %>%
select(game_date, pitcher, events, game_year, at_bat_number, inning) %>%
filter(events != "") %>%
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year) %>%
summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game))
View(strikeout_df)
platoon_s_k_pitches_query <- "
SELECT game_date, pitcher, events, type, game_year, stand, p_throws, at_bat_number, ax
FROM statcast
WHERE game_date NOT BETWEEN '2021-03-01' AND '2021-03-31'
AND game_date NOT BETWEEN '2015-03-28' AND '2015-04-04'
AND game_date NOT BETWEEN '2016-03-28' AND '2016-04-02'
AND game_date NOT BETWEEN '2017-03-28' AND '2017-04-01'
"
platoon_s_k_pitches_df <- dbGetQuery(conn, platoon_s_k_pitches_query)
strike_platoon_df <- platoon_s_k_pitches_df %>%
select(pitcher, game_year, stand, p_throws, type) %>%
group_by(pitcher, game_year) %>%
summarize(platoon_advantage = sum(stand == p_throws) / n(),
strike_percentage = sum(type != "B") / n())
strikeout_df <- platoon_s_k_pitches_df %>%
select(game_date, pitcher, events, game_year, at_bat_number, inning) %>%
filter(events != "") %>%
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year) %>%
summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game))
View(strikeout_df)
pitch_count_df <- platoon_s_k_pitches_df %>%
group_by(pitcher, game_year) %>%
summarize(pitch = n())
View(pitch_count_df)
platoon_s_k_pitches_query <- "
SELECT game_date, pitcher, events, type, game_year, stand, p_throws, at_bat_number
FROM statcast
WHERE game_date NOT BETWEEN '2021-03-01' AND '2021-03-31'
AND game_date NOT BETWEEN '2015-03-28' AND '2015-04-04'
AND game_date NOT BETWEEN '2016-03-28' AND '2016-04-02'
AND game_date NOT BETWEEN '2017-03-28' AND '2017-04-01'
"
platoon_s_k_pitches_df <- dbGetQuery(conn, platoon_s_k_pitches_query)
strike_platoon_df <- platoon_s_k_pitches_df %>%
select(pitcher, game_year, stand, p_throws, type) %>%
group_by(pitcher, game_year) %>%
summarize(platoon_advantage = sum(stand == p_throws) / n(),
strike_percentage = sum(type != "B") / n())
strikeout_df <- platoon_s_k_pitches_df %>%
select(game_date, pitcher, events, game_year, at_bat_number) %>%
filter(events != "") %>%
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year) %>%
summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game))
View(strikeout_df)
pitch_count_df <- platoon_s_k_pitches_df %>%
group_by(pitcher, game_year) %>%
summarize(pitch = n())
View(pitch_count_df)
joined_df <- merge(merge(merge(strike_platoon_df, pitch_count_df,
by = c("pitcher", "game_year"),
all.x = TRUE), strikeout_df,
by = c("pitcher", "game_year"), all.x = TRUE),
sql_df, by = c("pitcher", "game_year"),
all.x = TRUE)
View(joined_df)
library(DBI)
library(RPostgres)
library(RSQLite)
library(tidyverse)
library(baseballr)
library(xgboost)
library(shapr)
conn <- dbConnect(Postgres(), dbname = "drpstatcast", host = "localhost",
port = 5432, user = "postgres", password = "drppassword")
connn <- dbConnect(SQLite(),  dbname = "data/lahman_1871-2021.sqlite")
sql_df <- dbGetQuery(conn, read_file("week5.sql"))
id_df <- read.csv("player_ids.csv")
positions_query <- "
SELECT playerID, yearID, POS
FROM Fielding
WHERE yearID BETWEEN 2015 AND 2019 OR
yearID == 2021
GROUP BY playerID, POS
"
fielding_df <- dbGetQuery(connn, positions_query)
bbref_query <- "
SELECT playerID, bbrefID
FROM People
"
bbref_df <- dbGetQuery(connn, bbref_query)
positions_df <- merge(fielding_df, bbref_df, by.x="playerID",
by.y="playerID") %>%
select(bbrefID, POS)
names_df <- merge(positions_df, id_df, by.x="bbrefID", by.y="key_bbref") %>%
filter(POS == "P")
more_stats_query <- "
SELECT game_date, pitcher, events, type, game_year, stand, p_throws, at_bat_number
FROM statcast
WHERE game_date NOT BETWEEN '2021-03-01' AND '2021-03-31'
AND game_date NOT BETWEEN '2015-03-28' AND '2015-04-04'
AND game_date NOT BETWEEN '2016-03-28' AND '2016-04-02'
AND game_date NOT BETWEEN '2017-03-28' AND '2017-04-01'
"
more_stats_df <- dbGetQuery(conn, more_stats_query)
strike_platoon_df <- more_stats_df %>%
select(pitcher, game_year, stand, p_throws, type) %>%
group_by(pitcher, game_year) %>%
summarize(platoon_advantage = sum(stand == p_throws) / n(),
strike_percentage = sum(type != "B") / n())
strikeout_df <- more_stats_df %>%
select(game_date, pitcher, events, game_year, at_bat_number) %>%
filter(events != "") %>%
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year) %>%
summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game))
pitch_count_df <- more_stats_df %>%
group_by(pitcher, game_year) %>%
summarize(pitch_count = n())
joined_df <- merge(merge(merge(strike_platoon_df, pitch_count_df,
by = c("pitcher", "game_year"), all.x = TRUE),
strikeout_df, by = c("pitcher", "game_year"),
all.x = TRUE), sql_df, by = c("pitcher", "game_year"),
all.x = TRUE)
View(joined_df)
Views(names_df)
View(names_df)
View(names_df)
names_df <- merge(positions_df, id_df, by.x="bbrefID", by.y="key_bbref") %>%
select(-bbrefID) %>%
filter(POS == "P")
View(names_df)
named_joined_df <- merge(joined_df, names_df, by.x='pitcher', by.y='key_mlbam',
all.x = TRUE)
View(named_joined_df)
named_joined_df <- right_join(joined_df, names_df, by.x="pitcher", by.y="key_mlbam")
View(named_joined_df)
named_joined_df <- right_join(joined_df, names_df, "pitcher", "key_mlbam")
View(named_joined_df)
named_joined_df <- right_join(joined_df, names_df, x="pitcher", y="key_mlbam")
View(named_joined_df)
named_joined_df <- right_join(joined_df, names_df, join_by("pitcher" == "key_mlbam"))
View(named_joined_df)
View(names_df)
names_df <- merge(positions_df, id_df, by.x="bbrefID", by.y="key_bbref") %>%
select(-bbrefID) %>%
filter(POS == "P") %>%
colnames("POS", "name", "pitcher")
View(names_df)
names_df <- merge(positions_df, id_df, by.x="bbrefID", by.y="key_bbref") %>%
select(-bbrefID) %>%
filter(POS == "P")
colnames(names_df) <- colnames("POS", "name", "pitcher")
View(names_df)
names_df <- merge(positions_df, id_df, by.x="bbrefID", by.y="key_bbref") %>%
select(-bbrefID) %>%
filter(POS == "P")
colnames(names_df) <- c("POS", "name", "pitcher")
View(names_df)
named_joined_df <- right_join(joined_df, names_df, by="pitcher")
View(named_joined_df)
named_joined_df <- right_join(joined_df, names_df, by="pitcher") %>%
filter(pitch_count < 1000)
View(named_joined_df)
library(DBI)
library(RPostgres)
library(RSQLite)
library(tidyverse)
library(baseballr)
library(xgboost)
library(shapr)
conn <- dbConnect(Postgres(), dbname = "drpstatcast", host = "localhost",
port = 5432, user = "postgres", password = "drppassword")
connn <- dbConnect(SQLite(),  dbname = "data/lahman_1871-2021.sqlite")
sql_df <- dbGetQuery(conn, read_file("week5.sql"))
id_df <- read.csv("player_ids.csv")
positions_query <- "
SELECT playerID, yearID, POS
FROM Fielding
WHERE yearID BETWEEN 2015 AND 2019 OR
yearID == 2021
GROUP BY playerID, POS
"
fielding_df <- dbGetQuery(connn, positions_query)
bbref_query <- "
SELECT playerID, bbrefID
FROM People
"
bbref_df <- dbGetQuery(connn, bbref_query)
positions_df <- merge(fielding_df, bbref_df, by.x="playerID",
by.y="playerID") %>%
select(bbrefID, POS)
names_df <- merge(positions_df, id_df, by.x="bbrefID", by.y="key_bbref") %>%
select(-bbrefID) %>%
filter(POS == "P")
colnames(names_df) <- c("POS", "name", "pitcher")
more_stats_query <- "
SELECT game_date, pitcher, events, type, game_year, stand, p_throws, at_bat_number
FROM statcast
WHERE game_date NOT BETWEEN '2021-03-01' AND '2021-03-31'
AND game_date NOT BETWEEN '2015-03-28' AND '2015-04-04'
AND game_date NOT BETWEEN '2016-03-28' AND '2016-04-02'
AND game_date NOT BETWEEN '2017-03-28' AND '2017-04-01'
"
more_stats_df <- dbGetQuery(conn, more_stats_query)
strike_platoon_df <- more_stats_df %>%
select(pitcher, game_year, stand, p_throws, type) %>%
group_by(pitcher, game_year) %>%
summarize(platoon_advantage = sum(stand == p_throws) / n(),
strike_percentage = sum(type != "B") / n())
strikeout_df <- more_stats_df %>%
select(game_date, pitcher, events, game_year, at_bat_number) %>%
filter(events != "") %>%
group_by(pitcher, game_year, game_date, at_bat_number) %>%
summarize(strikeouts = sum(events == "strikeout")) %>%
summarize(strikeouts_game = sum(strikeouts),
at_bats_game = n_distinct(at_bat_number)) %>%
group_by(pitcher, game_year) %>%
summarize(strikeout_percentage = sum(strikeouts_game) / sum(at_bats_game))
pitch_count_df <- more_stats_df %>%
group_by(pitcher, game_year) %>%
summarize(pitch_count = n())
joined_df <- merge(merge(merge(strike_platoon_df, pitch_count_df,
by = c("pitcher", "game_year"), all.x = TRUE),
strikeout_df, by = c("pitcher", "game_year"),
all.x = TRUE), sql_df, by = c("pitcher", "game_year"),
all.x = TRUE)
named_joined_df <- right_join(joined_df, names_df, by="pitcher") %>%
filter(pitch_count < 1000)
View(named_joined_df)
